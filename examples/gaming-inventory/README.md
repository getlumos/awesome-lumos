# Gaming Inventory System - LUMOS Example

> Full-featured Web3 gaming system built with LUMOS-generated types for guaranteed type synchronization

This example demonstrates a production-ready gaming inventory and progression system with items, crafting, trading, and combat mechanics.

## üéØ What This Demonstrates

- **14 LUMOS type definitions** generating synchronized Rust + TypeScript
- **Complex item system** with 5 item types (Weapon, Armor, Accessory, Consumable, Material)
- **6 rarity levels** (Common, Uncommon, Rare, Epic, Legendary, Mythic)
- **Player progression** with leveling, XP, and stat increases
- **Crafting system** with material requirements and success rates
- **Trading system** with offers, expiration, and item/gold exchange
- **Combat simulation** with monster defeats and rewards
- **Type-safe game client** using generated TypeScript types

## üì¶ Project Structure

```
gaming-inventory/
‚îú‚îÄ‚îÄ schema/
‚îÇ   ‚îî‚îÄ‚îÄ game.lumos                 # Source of truth for all game types
‚îú‚îÄ‚îÄ programs/
‚îÇ   ‚îî‚îÄ‚îÄ gaming-inventory/
‚îÇ       ‚îú‚îÄ‚îÄ src/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ lib.rs             # Anchor program (11 instructions)
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ generated.rs       # ‚Üê Auto-generated by LUMOS
‚îÇ       ‚îî‚îÄ‚îÄ Cargo.toml
‚îî‚îÄ‚îÄ app/
    ‚îî‚îÄ‚îÄ src/
        ‚îú‚îÄ‚îÄ generated.ts           # ‚Üê Auto-generated by LUMOS
        ‚îî‚îÄ‚îÄ game-client.ts         # Type-safe game client
```

## üîß LUMOS Schema

```lumos
#[solana]
#[account]
struct Player {
    wallet: PublicKey,
    username: String,
    level: u16,
    experience: u64,
    gold: u64,
    health: u32,
    mana: u32,
    equipped_weapon: Option<PublicKey>,
    equipped_armor: Option<PublicKey>,
    equipped_accessory: Option<PublicKey>,
    total_items_owned: u64,
    total_monsters_defeated: u64,
    created_at: i64,
    last_login: i64,
}

#[solana]
#[account]
struct GameItem {
    id: u64,
    owner: PublicKey,
    name: String,
    item_type: ItemType,
    rarity: Rarity,
    level_requirement: u16,
    power: u32,
    defense: u32,
    durability: u32,
    max_durability: u32,
    is_equipped: bool,
    is_tradeable: bool,
    created_at: i64,
}

#[solana]
enum ItemType {
    Weapon { damage: u32, attack_speed: u32 },
    Armor { defense_bonus: u32, health_bonus: u32 },
    Accessory { mana_bonus: u32, luck_bonus: u32 },
    Consumable { effect: ConsumableEffect, uses: u32 },
    Material { tier: u8 },
}

#[solana]
enum Rarity {
    Common,      // Gray
    Uncommon,    // Green
    Rare,        // Blue
    Epic,        // Purple
    Legendary,   // Orange
    Mythic,      // Red
}

// + 10 more types (ConsumableEffect, CraftingRecipe, TradeOffer, Achievement, GameEvent, etc.)
```

**Total:** 14 types ‚Üí 2 auto-generated files (Rust + TypeScript)

## üöÄ Setup

### 1. Install Dependencies

```bash
# Install LUMOS CLI
cargo install lumos-cli

# Install Anchor
cargo install --git https://github.com/coral-xyz/anchor --tag v0.32.1 anchor-cli

# Install Node dependencies
npm install
```

### 2. Generate Code

```bash
# Generate Rust + TypeScript from schema
lumos generate schema/game.lumos --output programs
```

This creates:
- `programs/gaming-inventory/src/generated.rs` - Rust structs and enums
- `app/src/generated.ts` - TypeScript interfaces and Borsh schemas

### 3. Build Program

```bash
cargo build --manifest-path programs/gaming-inventory/Cargo.toml
```

### 4. Deploy to Devnet

```bash
anchor deploy --provider.cluster devnet
```

## üìö Game Mechanics

### 1. Create Player

Start your gaming journey by creating a player account.

**Rust:**
```rust
pub fn create_player(
    ctx: Context<CreatePlayer>,
    username: String,  // 3-20 characters
) -> Result<()>
```

**TypeScript:**
```typescript
const player = await client.createPlayer({
  authority: wallet,
  username: 'DragonSlayer',
});

// Player starts with:
// - Level 1
// - 0 XP
// - 1,000 gold
// - 1,000 health
// - 500 mana

const playerData: Player = await client.getPlayer(player);
console.log(`Welcome, ${playerData.username}!`);
console.log(`Level ${playerData.level} | ${playerData.gold} gold`);
```

### 2. Mint Items

Create new items with specific attributes.

**Rust:**
```rust
pub fn mint_item(
    ctx: Context<MintItem>,
    name: String,
    item_type: ItemType,
    rarity: Rarity,
    level_requirement: u16,
    power: u32,
    defense: u32,
) -> Result<()>
```

**TypeScript:**
```typescript
// Mint a legendary weapon
const excalibur = await client.mintItem({
  player,
  authority: wallet,
  name: 'Excalibur',
  itemType: {
    Weapon: {
      damage: 200,
      attackSpeed: 85,
    },
  } as ItemType,
  rarity: 'Legendary',
  levelRequirement: 15,
  power: 200,
  defense: 0,
});

// Mint epic armor
const dragonArmor = await client.mintItem({
  player,
  authority: wallet,
  name: 'Dragon Scale Armor',
  itemType: {
    Armor: {
      defenseBonus: 150,
      healthBonus: 500,
    },
  } as ItemType,
  rarity: 'Epic',
  levelRequirement: 12,
  power: 0,
  defense: 150,
});

// Fetch item data
const item: GameItem = await client.getItem(excalibur);
console.log(`${item.name} - ${item.rarity}`);
console.log(`Power: ${item.power} | Defense: ${item.defense}`);
console.log(`Durability: ${item.durability}/${item.maxDurability}`);
```

### 3. Equipment System

Equip and unequip items to boost your stats.

**Rust:**
```rust
pub fn equip_item(ctx: Context<EquipItem>) -> Result<()>
pub fn unequip_item(ctx: Context<UnequipItem>) -> Result<()>
```

**TypeScript:**
```typescript
// Equip weapon
await client.equipItem({
  player,
  item: excalibur,
  authority: wallet,
});

// Equip armor
await client.equipItem({
  player,
  item: dragonArmor,
  authority: wallet,
});

// Check equipped items
const playerData = await client.getPlayer(player);
console.log(`Weapon: ${playerData.equippedWeapon}`);
console.log(`Armor: ${playerData.equippedArmor}`);
console.log(`Accessory: ${playerData.equippedAccessory}`);

// Get total stats
const stats = await client.getPlayerStats(player);
console.log(`Total Power: ${stats.totalPower}`);
console.log(`Total Defense: ${stats.totalDefense}`);

// Unequip when needed
await client.unequipItem({
  player,
  item: excalibur,
  authority: wallet,
});
```

### 4. Combat System

Defeat monsters to earn XP and gold!

**Rust:**
```rust
pub fn defeat_monster(
    ctx: Context<DefeatMonster>,
    monster_level: u16,
) -> Result<()>
```

**TypeScript:**
```typescript
// Fight a Level 5 monster
await client.defeatMonster({
  player,
  authority: wallet,
  monsterLevel: 5,
});

// Rewards earned:
// XP: monster_level √ó 100 = 500 XP
// Gold: monster_level √ó 50 = 250 gold

// Check progress
const playerData = await client.getPlayer(player);
console.log(`XP: ${playerData.experience}`);
console.log(`Gold: ${playerData.gold}`);
console.log(`Monsters defeated: ${playerData.totalMonstersDefeated}`);

// Level up when XP reaches threshold
// Level 1 ‚Üí 2: 1,000 XP required
// Level 2 ‚Üí 3: 2,000 XP required
// Level N ‚Üí N+1: N √ó 1,000 XP required

// Level up bonuses:
// +100 Health
// +50 Mana
```

### 5. Crafting System

Craft new items using materials and gold.

**Rust:**
```rust
pub fn craft_item(
    ctx: Context<CraftItem>,
    name: String,
    item_type: ItemType,
    rarity: Rarity,
    power: u32,
) -> Result<()>
```

**TypeScript:**
```typescript
const ironSword = await client.craftItem({
  player,
  authority: wallet,
  name: 'Iron Sword',
  itemType: {
    Weapon: {
      damage: 50,
      attackSpeed: 70,
    },
  } as ItemType,
  rarity: 'Rare',
  power: 50,
});

// Crafting costs based on rarity:
// Common: 100 gold
// Uncommon: 250 gold
// Rare: 500 gold
// Epic: 1,000 gold
// Legendary: 2,500 gold
// Mythic: 5,000 gold
```

### 6. Item Upgrades

Upgrade items to increase their power.

**Rust:**
```rust
pub fn upgrade_item(
    ctx: Context<UpgradeItem>,
    power_increase: u32,
) -> Result<()>
```

**TypeScript:**
```typescript
// Upgrade by +10 power
await client.upgradeItem({
  player,
  item: ironSword,
  authority: wallet,
  powerIncrease: 10,
});

// Upgrade cost: power_increase √ó 10 gold
// +10 power = 100 gold
// +50 power = 500 gold

const upgraded = await client.getItem(ironSword);
console.log(`New power: ${upgraded.power}`); // 60 (50 + 10)
```

### 7. Consumables

Use consumable items for temporary or permanent effects.

**Rust:**
```rust
pub fn consume_item(ctx: Context<ConsumeItem>) -> Result<()>
```

**TypeScript:**
```typescript
// Mint health potion
const healthPotion = await client.mintItem({
  player,
  authority: wallet,
  name: 'Health Potion',
  itemType: {
    Consumable: {
      effect: {
        HealHealth: { amount: 500 },
      } as ConsumableEffect,
      uses: 3,
    },
  } as ItemType,
  rarity: 'Common',
  levelRequirement: 1,
  power: 0,
  defense: 0,
});

// Use the potion
await client.consumeItem({
  player,
  item: healthPotion,
  authority: wallet,
});

// Player health increased by 500!
```

**Consumable Effects:**
- `HealHealth` - Restore health points
- `RestoreMana` - Restore mana points
- `BoostExperience` - Increase XP gain (percentage, duration)
- `IncreaseGold` - Increase gold drops (percentage, duration)

### 8. Trading System

Trade items with other players.

**Rust:**
```rust
pub fn create_trade_offer(
    ctx: Context<CreateTradeOffer>,
    requested_gold: Option<u64>,
    requested_item_type: Option<ItemType>,
    requested_min_rarity: Option<Rarity>,
    recipient: Option<Pubkey>,
    duration: i64,
) -> Result<()>

pub fn accept_trade(
    ctx: Context<AcceptTrade>,
    gold_payment: Option<u64>,
) -> Result<()>

pub fn cancel_trade(ctx: Context<CancelTrade>) -> Result<()>
```

**TypeScript:**
```typescript
// Create trade offer (item for gold)
const trade = await client.createTradeOffer({
  player,
  item: dragonArmor,
  authority: wallet,
  requestedGold: 5000, // Want 5,000 gold
  duration: 7 * 24 * 60 * 60, // 7 days
});

// Create trade offer (item for item)
const itemTrade = await client.createTradeOffer({
  player,
  item: excalibur,
  authority: wallet,
  requestedItemType: {
    Armor: {
      defenseBonus: 0,
      healthBonus: 0,
    },
  } as ItemType,
  requestedMinRarity: 'Epic',
  recipient: otherPlayerAddress, // Optional: specific recipient
  duration: 3 * 24 * 60 * 60, // 3 days
});

// Accept a trade
await client.acceptTrade({
  trade: tradeAddress,
  offererPlayer: player1,
  accepterPlayer: player2,
  offeredItem: itemAddress,
  paymentItem: paymentItemAddress,
  authority: wallet2,
  goldPayment: 5000,
});

// Cancel your trade
await client.cancelTrade({
  player,
  trade: tradeAddress,
  authority: wallet,
});

// Check trade status
const tradeData: TradeOffer = await client.getTradeOffer(trade);
console.log(`Status: ${tradeData.status}`); // Open/Accepted/Cancelled/Expired
```

## üéÆ Rarity System

### Rarity Levels

| Rarity | Color | Drop Rate | Durability | Crafting Cost |
|--------|-------|-----------|------------|---------------|
| Common | Gray | 50% | 100 | 100 gold |
| Uncommon | Green | 25% | 150 | 250 gold |
| Rare | Blue | 15% | 200 | 500 gold |
| Epic | Purple | 7% | 300 | 1,000 gold |
| Legendary | Orange | 2.5% | 500 | 2,500 gold |
| Mythic | Red | 0.5% | 1,000 | 5,000 gold |

### Rarity Multipliers

```typescript
const multiplier = client.getRarityMultiplier(rarity);

// Common: 1.0x
// Uncommon: 1.5x
// Rare: 2.0x
// Epic: 3.0x
// Legendary: 5.0x
// Mythic: 10.0x
```

## ‚öîÔ∏è Item Types

### Weapon
```typescript
{
  Weapon: {
    damage: 150,      // Base damage
    attackSpeed: 80,  // Attack speed (0-100)
  }
}
```

### Armor
```typescript
{
  Armor: {
    defenseBonus: 100,  // Defense points
    healthBonus: 500,   // Max health increase
  }
}
```

### Accessory
```typescript
{
  Accessory: {
    manaBonus: 200,  // Max mana increase
    luckBonus: 10,   // Luck stat increase
  }
}
```

### Consumable
```typescript
{
  Consumable: {
    effect: ConsumableEffect,
    uses: 3,  // Number of uses
  }
}
```

### Material
```typescript
{
  Material: {
    tier: 5,  // Material tier (1-10)
  }
}
```

## üìä Progression System

### Experience & Leveling

```
XP Required = Current Level √ó 1,000

Level 1 ‚Üí 2: 1,000 XP
Level 2 ‚Üí 3: 2,000 XP
Level 5 ‚Üí 6: 5,000 XP
Level 10 ‚Üí 11: 10,000 XP
```

**Level Up Bonuses:**
- +100 Health
- +50 Mana

### Combat Rewards

```
XP Earned = Monster Level √ó 100
Gold Earned = Monster Level √ó 50

Level 5 Monster:
- 500 XP
- 250 gold

Level 20 Monster:
- 2,000 XP
- 1,000 gold
```

## üîÑ Type Synchronization Benefits

### Without LUMOS (Manual Approach)

Adding a new item type:

1. ‚úèÔ∏è Update Rust enum
2. ‚úèÔ∏è Update TypeScript type
3. ‚úèÔ∏è Update Borsh schema
4. ‚úèÔ∏è Update match statements
5. ‚úèÔ∏è Update frontend rendering
6. ‚ùå **Risk:** Type mismatches, serialization bugs

**Time:** 20-30 minutes + debugging

### With LUMOS

1. ‚úèÔ∏è Update `.lumos` schema
2. ü§ñ Run `lumos generate`
3. ‚úèÔ∏è Update match statements

**Time:** 5 minutes, **zero type bugs**

## üéØ Frontend Integration

```typescript
import { GameClient } from './game-client';
import { Player, GameItem, ItemType, Rarity } from './generated';

// All types are automatically synchronized!
async function displayInventory(playerAddress: PublicKey) {
  const player: Player = await client.getPlayer(playerAddress);

  console.log(`=== ${player.username}'s Profile ===`);
  console.log(`Level: ${player.level}`);
  console.log(`XP: ${player.experience} / ${player.level * 1000}`);
  console.log(`Gold: ${player.gold}`);
  console.log(`Health: ${player.health} HP`);
  console.log(`Mana: ${player.mana} MP`);

  // Get equipped items
  if (player.equippedWeapon) {
    const weapon: GameItem = await client.getItem(player.equippedWeapon);
    const color = client.getRarityColor(weapon.rarity);
    console.log(`‚öîÔ∏è  ${weapon.name} (${weapon.rarity})`);
  }

  if (player.equippedArmor) {
    const armor: GameItem = await client.getItem(player.equippedArmor);
    console.log(`üõ°Ô∏è  ${armor.name} (${armor.rarity})`);
  }

  // Get combat stats
  const stats = await client.getPlayerStats(playerAddress);
  console.log(`\n=== Combat Stats ===`);
  console.log(`Total Power: ${stats.totalPower}`);
  console.log(`Total Defense: ${stats.totalDefense}`);
  console.log(`Progress: ${stats.progressToNextLevel.toFixed(2)}%`);
}

// Render item with rarity color
function renderItem(item: GameItem) {
  const color = client.getRarityColor(item.rarity);
  const value = client.calculateItemValue(item);
  const typeDesc = client.formatItemType(item.itemType);

  return `
    <div style="border-color: ${color}">
      <h3 style="color: ${color}">${item.name}</h3>
      <p>${typeDesc}</p>
      <p>Power: ${item.power} | Defense: ${item.defense}</p>
      <p>Durability: ${item.durability}/${item.maxDurability}</p>
      <p>Value: ${value} gold</p>
      ${item.isEquipped ? '<span>‚ö° EQUIPPED</span>' : ''}
    </div>
  `;
}
```

## üöÄ Extending This Example

### Add Quest System

Update `.lumos` schema:

```lumos
#[solana]
#[account]
struct Quest {
    id: u64,
    title: String,
    description: String,
    requirements: Vec<QuestRequirement>,
    rewards: QuestRewards,
    status: QuestStatus,
}

#[solana]
enum QuestStatus {
    Available,
    InProgress,
    Completed,
    Failed,
}
```

### Add Guild System

```lumos
#[solana]
#[account]
struct Guild {
    name: String,
    leader: PublicKey,
    members: Vec<PublicKey>,
    treasury: u64,
    level: u16,
}
```

### Add PvP Arena

```lumos
#[solana]
#[account]
struct ArenaMatch {
    player1: PublicKey,
    player2: PublicKey,
    winner: Option<PublicKey>,
    wager: u64,
    status: MatchStatus,
}
```

## üìà Real-World Impact

| Metric | Value |
|--------|-------|
| Development Time Saved | 3x faster |
| Type Synchronization Bugs | 0 (impossible) |
| Item Types Supported | 5 with variants |
| Rarity Levels | 6 |
| Game Mechanics | 11 instructions |

## üîó Learn More

- **LUMOS Documentation:** https://lumos-lang.org
- **Anchor Documentation:** https://anchor-lang.com
- **Solana Game Development:** https://solana.com/developers/guides/games

## üìù License

MIT

---

**Built with LUMOS** - Type-safe schema language for Solana game development
